#+TITLE: mrcal 2.4 release notes
#+OPTIONS: toc:nil

* New in mrcal 2.4

363c9f9ce9e9a02aa249bf97ccf137fdd6115a64
numpy.linalg.lstsq() calls work even in old numpy releases

fixed mrcal.show_geometry() axis_scale logic: e3e29bab

2023-06-09 mrcal.show_projection_diff() has contour options like mrcal.show_projection_uncertainty()

commit 09d52a7f4475615db8f454f111246204b7279596
Date:   Tue Jun 20 16:07:57 2023 -0700
  mrcal-stereo, stereo_range() work properly if disparity_min > 0
  Invalid-disparity areas are now interpreted properly

commit 97298695e24d4e083ce7496fe42fd2a88a0083f3
Date:   Wed Jun 21 22:52:05 2023 -0700
  All the tools use /usr/bin/env in the #!
  Mac user who live life on hard mode now have it slightly easier

7aae63c8, previous one
build compat: no _GNU_SOURCE, glibc requirement

commit 700a18a01370a14e2f947c9fe24fdb7acdedcb10
Date:   Thu Jun 15 21:40:20 2023 -0700
  Support the more recent CHOLMOD APIs

Python API: renamed residuals_chessboard -> residuals_board
The previous name is still available for backwards compatibility

4923218d..: show_residuals_board_observation() and cmdline tool have --cbmax

073f55b5..: show_residuals_vectorfield(), .._magnitudes(), mrcal-show-residuals have --cbmax

Added CHOLMOD_factorization.rcond()

mrcal.worst_direction_stdev() works with NxN arrays, not just 2x2

mrcal.ref_calibration_object has optimization_inputs argument
This provides a convenient shorthand to get the object used in a particular
calibration

03f030: Procrustes transform functions detect and report errors

Added [[file:mrcal-python-api-reference.html#-R_aligned_to_vector][=mrcal.R_aligned_to_vector()=]]

Added [[file:mrcal-python-api-reference.html#-sorted_eig][=mrcal.sorted_eig()=]]

mrcal_rectification_maps() supports latlon AND pinhole rectification

mrcal builds with clang

mrcal-from-kalibr, mrcal-to-kalibr
mrcal-from-ros

write_point_cloud_as_ply() exported

lensmodel parsing: more detailed error codes

C API: more types defined

mrcal_apply_color_map() available in C, for many types

mrcal.apply_color_map() uses the C function internally. All gnuplot colormap
functions supported

mrcal-stereo gui displays the pixel coordinates for both cameras

bgr_t -> mrcal_bgr_t

C API: mrcal_lensmodel_name...() return NULL if given an invalid model

Added mrcal_stereo_range_sparse() and mrcal_stereo_range_dense();
mrcal.stereo_range() uses those

mrcal.stereo_range() has optional disparity_max parameter; and
disparity_scaled_min, disparity_scaled_max

added demo for dense stereo in C

C API: mrcal_lensmodel_..._from_name() handles NULL gracefully

* Migration notes 2.3 -> 2.4

commit 76248fce8655fba0aec1175157cbe8f8da055b7a
Date:   Wed Jun 21 18:24:50 2023 -0700
  do_optimize_calobject_warp is true ONLY if Nobservations_board>0 is also true
  THIS IS A C-API-BREAKING CHANGE: mrcal_pack_solver_state_vector() and
  mrcal_unpack_solver_state_vector() now take one more argument.
  Prior to this patch you could get into an inconsistent state where different
  parts of the code has different ideas about what Nstate was


Python API: renamed residuals_chessboard -> residuals_board
The previous name is still available for backwards compatibility.
Use the new name if you can. You don't HAVE to

mrcal.apply_color_map(): a_min, a_max MUST now be passed in as kwargs, instead
of positionals.

C API. Renamed type: bgr_t -> mrcal_bgr_t

mrcal._elas_nsps.stereo_matching_libelas() kwargs renamed: disp_min/max ->
disparity_min/max
